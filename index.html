<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0"
    />
    <title>Idyll Custom Components</title>
    <meta property="og:title" content="Idyll Custom Components" />
    <meta charset="utf-8" />
    <meta property="og:type" content="article" />

    <meta property="og:description" content="Short description of your project" />
    <meta property="description" content="Short description of your project" />

    <link rel="stylesheet" href="static/idyll_styles.css" />
  </head>
  <body>
    <div id="idyll-mount"><div data-reactroot=""><div class="idyll-root"><div class=" idyll-text-container"></div><div class="article-header" style="background:#222222;color:#ffffff"><h1 class="hed">WIP: Idyll Custom Components</h1><h2 class="dek">Creating your own custom components in Idyll</h2><div class="byline">By: <a href="https://github.com/tanalan">Alan Tan</a></div><div class="idyll-pub-date">Thu Apr 09 2020</div></div><div class=" idyll-text-container"><h2 id="introduction">Introduction</h2><p>Idyll is already rich with many <a href="https://idyll-lang.org/docs/components">built-it</a> components.
This article serves as a tutorial for writing your own custom components (in React)
in Idyll, and is an extension to Idyll’s <a href="https://idyll-lang.org/docs/components/custom">current docs</a> with custom components.</p><p><strong>TODO</strong> This article assumes basic knowledge from Idyll’s docs. (Wording?).</p><p>Since Idyll components are React components under the hood, it may be good to be familiar with the basics of React.
Their <a href="https://reactjs.org/docs/getting-started.html">docs</a> are well documented, and serve as a great starting point for learning React.</p><blockquote>Idyll posts are designed to support interaction and data-driven graphics.</blockquote><p>I will focus on creating a (basic?) custom component emphasizes Idyll’s interaction functionality, and ....??? TODO</p><h2 id="core-custom-component-ideas">Core custom component ideas</h2><p>Very important to an Idyll document’s interactivity is its interaction with <strong>variables</strong>. This is important for
writing custom components that have interactivity with users, as well as other components.</p><h2 id="writing-custom-components">Writing custom components</h2><p>In Idyll, a variable can be <em>binded</em> to a component’s property (<code>prop</code>). If this variable is updated, all
components with a bind to this variable also updates with this new value.<br/>
In particular, for all custom components, Idyll injects an <code>updateProps</code>
method into the <code>props</code> object of a custom component. We pass our variables
into a custom component’s <code>props</code>, and the component can <code>updateProps</code>, which
facilitate interaction, because these same variables’ updated values will affect its other components!
<br/></p><p>This is very powerful.</p><p>I demonstrate this by interacting with a small basic custom component, <code>TwoColors</code>.
Try clicking on a colored section below, and notice how the color selected text changes.</p><div><div class="square-green" style="background-color:green;width:100px;height:100px;text-align:center">Green</div><div class="square-orange" style="background-color:orange;width:100px;height:100px;text-align:center">Orange</div></div><p>The color clicked is <span class="idyll-display">not yet chosen</span></p><p>Let’s go over how I made this!

I defined my own custom component, <code>TwoColors</code>, in a file called <code>two-colors.js</code> in my components/ folder, so Idyll knows about it.
The contents start out in a basic React template:</p><pre><code>import React from &#x27;react&#x27;;

class TwoColors extends React.PureComponent {
  constructor(props) {
    super(props);
  }

  render() {
    // ... rendered output here
  }
}

export default TwoColors;</code></pre><p>Note: The <code>export default TwoColors;</code> statement  allows Idyll to find the component <code>TwoColors</code>.
See <a href="https://developer.mozilla.org/en-US/docs/web/javascript/reference/statements/export">export</a> docs for more info.</p><p>Now, let’s render two squares of 100x100 pixels. We will render them as <code>div</code>s, and wrap them inside a container <code>div</code>.
So now, <code>render()</code> looks like:</p><pre><code>render() {
  return (
    &lt;div&gt;
      &lt;div
        className=&quot;square-green&quot;
        style={{
          backgroundColor: &#x27;green&#x27;,
          width: &#x27;100px&#x27;,
          height: &#x27;100px&#x27;,
          textAlign: &#x27;center&#x27;
        }}
      &gt;
        Green 
      &lt;/div&gt;
      &lt;div
        className=&quot;square-orange&quot;
        style={{
          backgroundColor: &#x27;orange&#x27;,
          width: &#x27;100px&#x27;,
          height: &#x27;100px&#x27;,
          textAlign: &#x27;center&#x27;
        }}
      &gt;
        Orange
      &lt;/div&gt;
    &lt;/div&gt;
  );
}</code></pre><p>I injected CSS styling into the square <code>div</code>’s <code>style</code> property.</p><p>Now, inside our <code>index.idyll</code> file, we can create a <code>TwoColors</code> component via:</p><pre><code>[TwoColors /]</code></pre><p>
and we get the output:</p><div><div class="square-green" style="background-color:green;width:100px;height:100px;text-align:center">Green</div><div class="square-orange" style="background-color:orange;width:100px;height:100px;text-align:center">Orange</div></div><p>Great! Now, let’s add some interactivity!
Inside <code>index.idyll</code>, we define a variable that will track the last clicked color.
Because we initially haven’t clicked any color, we’ll initialize the variable’s value to <code>undefined</code>.</p><pre><code>[var name:&quot;lastClickedColor&quot; value:undefined /]</code></pre><p>Then, we’ll <em>bind</em> this variable to a property of <code>TwoColors</code>! Let’s call this property <code>selectedColor</code>, just to
differentiate between our variable and the prop.</p><pre><code>[var name:&quot;lastClickedColor&quot; value:undefined /]
[TwoColors selectedColor:lastClickedColor /]</code></pre><p>Inside <code>TwoColors</code>, we’ll add a click event to each square, and upon clicking, the square will update the <code>selectedColor</code> prop,
which will update our <code>lastClickedColor</code> variable. Let’s add <code>onClick</code> events to both squares. Our updated <code>render()</code> looks like:</p><pre><code>render() {
  // TODO Would it be okay to use `React.Fragment` instead? Or unnecessary information?
  return (
    &lt;div&gt;
      &lt;div
        className=&quot;square-green&quot;
        style={{
          backgroundColor: &#x27;green&#x27;,
          width: &#x27;100px&#x27;,
          height: &#x27;100px&#x27;,
          textAlign: &#x27;center&#x27;
        }}
        onClick={() =&gt; this.changePropsColor(&#x27;green&#x27;)}
      &gt;
        Green 
      &lt;/div&gt;
      &lt;div
        className=&quot;square-orange&quot;
        style={{
          backgroundColor: &#x27;orange&#x27;,
          width: &#x27;100px&#x27;,
          height: &#x27;100px&#x27;,
          textAlign: &#x27;center&#x27;
        }}
        onClick={() =&gt; this.changePropsColor(&#x27;orange&#x27;)}
      &gt;
        Orange
      &lt;/div&gt;
    &lt;/div&gt;
  );
}</code></pre><p>Let’s also define the <code>changePropsColor</code> function! It will accept a <code>color</code> parameter,
and then <code>updateProps()</code> to the clicked color! (Notice how we passed <code>green</code> and <code>orange</code>, respectively).</p><pre><code>constructor(props) {
  super(props);
  
  this.changePropsColor = this.changePropsColor.bind(this);
}

changePropsColor(color) {
  this.props.updateProps({ // This uses the `updateProps` method that Idyll injects into components
    currentColor: color
  });
}</code></pre><p>Note: I added that <code>bind</code> call in the constructor because of how class methods work in Javascript. Read more <a href="https://reactjs.org/docs/handling-events.html">here</a>.</p><p>Now, when we click on a square, the <code>changePropsColor</code> function is called, and the <code>selectedColor</code> prop updates to the color clicked,
and then the <code>lastClickedColor</code> variable becomes updated to the color selected (“green” or “orange”).</p><p>Finally, let’s now display our <code>lastClickedColor</code> to see it update live!

We’ll use Idyll’s default Display component to display the variable!

</p><pre><code>[var name:&quot;lastClickedColor&quot; value:undefined /]
[TwoColors selectedColor:lastClickedColor /]

The color clicked is [Display value:`lastClickedColor ? lastClickedColor : &quot;not yet chosen&quot;` /]</code></pre><p>Which results in what we saw before:<div><div class="square-green" style="background-color:green;width:100px;height:100px;text-align:center">Green</div><div class="square-orange" style="background-color:orange;width:100px;height:100px;text-align:center">Orange</div></div></p><p>The color clicked is <span class="idyll-display">not yet chosen</span></p><h2 id="a-custom-budget-component">A custom budget component</h2><p>TODO showing a more complex and useful example that shows data.</p><p>A budgeter bar where the user interacts by having a budget amount, and adding spendings that will change how the bar looks.
This way, they can get a visualization of how much of their budget is going into what category.</p><div style="background-color:lightGreen">$$$$</div></div></div></div></div>
    <script src="static/idyll_index.js"></script>
  </body>
</html>
